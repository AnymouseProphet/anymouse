\NeedsTeXFormat{LaTeX2e}
\def\fileversion{0.1}
\def\filedate{2021/07/21}
\ProvidesPackage{ampbiology}[\filedate\space v\fileversion]
%% Copyright 2021 The Anymouse Prophet
%
% This file may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This file may also be distributed and/or modified under the
% conditions of the MIT license. See
%   https://opensource.org/licenses/MIT
%
% To include this file in a larger project, you may choose
% one or both licenses at your discretion.
%
\message{`ampbiology' v\fileversion, \filedate\space Sets up biology macros (anymouseprophet)}

\RequirePackage{iftex}
\RequirePackage{kvoptions}
\RequirePackage{ifthen}
\providecommand{\ampusefontspec}{no}
\providecommand{\amppdftexenc}{\encodingdefault}%preserve what is already set if already set
\ifthenelse{\equal{\amppdftexenc}{OT1}}{
  \renewcommand{\amppdftexenc}{T1}
}{}
\ifthenelse{\equal{\amppdftexenc}{TU}}{
  \renewcommand{\amppdftexenc}{T1}
}{}
\providecommand{\ampitalics}{yes}
\providecommand{\miscedition}{foo}
%
\define@key{amp}{reditalics}[]{\renewcommand{\ampitalics}{no}}
\define@key{amp}{edition}[bar]{\renewcommand{\miscedition}{#1}}
\InputIfFileExists{./anymouse.cfg}{}{}
\ProcessKeyvalOptions{amp}
\ifthenelse{\equal{\miscedition}{sans}}{
  \renewcommand{\ampitalics}{no}
}{}
%
\@ifpackageloaded{fontspec}{
  \newfontfamily{\taxonomyfont}{Krub}[ Ligatures={NoCommon, NoDiscretionary, NoHistoric, NoRequired, NoContextual} ,
      Extension   = .ttf ,
      Scale = MatchLowercase ,
      UprightFont = *-Medium ,
      ItalicFont  = *-MediumItalic ,
      BoldFont    = *-SemiBold ,
      BoldItalicFont = *-SemiBoldItalic ]
  \newfontface{\genefont}{ArchivoNarrow}[ Ligatures={NoCommon, NoDiscretionary, NoHistoric, NoRequired, NoContextual} ,
      Extension   = .ttf ,
      Scale = MatchUppercase ,
      UprightFont = *-Regular ,
      ItalicFont  = *-Italic ,
      BoldFont    = *-SemiBold ,
      BoldItalicFont = *-SemiBoldItalic ]
}{
  % I suspect requiring T1 fontenc isn't needed even if default encoding isn't T1
  \ifthenelse{\equal{\amppdftexenc}{T1}}{
    \RequirePackage[T1]{fontenc}
  }{
    \RequirePackage[T1,\amppdftexenc]{fontenc}
  }
  \newcommand{\taxonomyfont}{\fontencoding{T1}\fontfamily{krub}\fontseries{m}\selectfont}
  % fix below
  \newcommand{\genefont}{\fontencoding{T1}\fontfamily{krub}\fontseries{m}\selectfont}
}

\ifthenelse{\equal{\ampitalics}{yes}}{
  \newcommand{\taxonomy}[1]{\begingroup\taxonomyfont\textit{#1}\endgroup}
}{
  \newcommand{\taxonomy}[1]{\begingroup\taxonomyfont\underline{#1}\endgroup}
}
\newcommand{\chromosome}[1]{\begingroup\genefont\textbf{#1}\endgroup}
\newcommand{\allele}[1]{\begingroup\genefont\textit{#1}\endgroup}
\newcommand{\twoallele}[2]{\begingroup\genefont\textit{#1\textsuperscript{#2}}\endgroup}

\newcommand{\genotype}[2]{\allele{#1}\allele{#2}}
\newcommand{\twogenotype}[3]{\twoallele{#1}{#2}\twoallele{#1}{#3}}








% hyphenation rules
\hyphenation{chrono-species}


\endinput
